openapi: 3.0.3
info:
  title: Uni-Chat API
  description: |
    Uni-Chat is a full-stack AI chat application using OpenRouter for multi-model access.

    Features include:
    - Real-time streaming chat
    - Image generation
    - Workflow editor
    - Arena mode for side-by-side AI comparison

    ## Authentication
    All protected endpoints require a JWT Bearer token in the Authorization header:
    ```
    Authorization: Bearer <access_token>
    ```

    ## Error Responses
    All errors follow a consistent format:
    ```json
    {
      "error": "Error message description"
    }
    ```
  version: 1.0.0
  contact:
    name: Uni-Chat Support

servers:
  - url: /api
    description: API base path

tags:
  - name: Auth
    description: Authentication and user management
  - name: Conversations
    description: Conversation management
  - name: Chat
    description: Chat messaging and AI responses
  - name: Configs
    description: LLM configuration management

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT access token obtained from /auth/login

  schemas:
    Error:
      type: object
      properties:
        error:
          type: string
          description: Error message
      required:
        - error

    User:
      type: object
      properties:
        id:
          type: string
          description: User ID
        email:
          type: string
          format: email
        display_name:
          type: string
        role:
          type: string
          enum: [user, admin]
        avatar_url:
          type: string
          nullable: true

    UserProfile:
      type: object
      properties:
        id:
          type: string
        email:
          type: string
          format: email
        role:
          type: string
        profile:
          type: object
          properties:
            display_name:
              type: string
            avatar_url:
              type: string
              nullable: true
            bio:
              type: string
        settings:
          type: object
        usage:
          type: object
          properties:
            messages_sent:
              type: integer
            tokens_used:
              type: integer
            tokens_limit:
              type: integer
        created_at:
          type: string
          format: date-time

    LoginRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          format: password

    LoginResponse:
      type: object
      properties:
        access_token:
          type: string
        refresh_token:
          type: string
        token_type:
          type: string
          example: Bearer
        expires_in:
          type: integer
          description: Token expiration in seconds
          example: 900
        user:
          $ref: '#/components/schemas/User'

    RegisterRequest:
      type: object
      required:
        - email
        - password
        - display_name
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          format: password
          minLength: 8
        display_name:
          type: string
          minLength: 2
          maxLength: 50

    TokenRefreshResponse:
      type: object
      properties:
        access_token:
          type: string
        token_type:
          type: string
          example: Bearer
        expires_in:
          type: integer
          example: 900

    Conversation:
      type: object
      properties:
        id:
          type: string
        user_id:
          type: string
        config_id:
          type: string
        title:
          type: string
        folder_id:
          type: string
          nullable: true
        tags:
          type: array
          items:
            type: string
        message_count:
          type: integer
        is_pinned:
          type: boolean
        is_archived:
          type: boolean
        created_at:
          type: string
          format: date-time
        last_message_at:
          type: string
          format: date-time

    ConversationCreate:
      type: object
      required:
        - config_id
      properties:
        config_id:
          type: string
          description: LLM configuration ID to use
        title:
          type: string
          default: New conversation
        folder_id:
          type: string
          nullable: true

    ConversationUpdate:
      type: object
      properties:
        title:
          type: string
        folder_id:
          type: string
          nullable: true
        tags:
          type: array
          items:
            type: string
        is_pinned:
          type: boolean

    Message:
      type: object
      properties:
        id:
          type: string
        conversation_id:
          type: string
        role:
          type: string
          enum: [user, assistant, system, error]
        content:
          type: string
        attachments:
          type: array
          items:
            type: object
            properties:
              type:
                type: string
              url:
                type: string
        metadata:
          type: object
          properties:
            model_id:
              type: string
            tokens:
              type: object
              properties:
                prompt:
                  type: integer
                completion:
                  type: integer
            generation_time_ms:
              type: integer
            finish_reason:
              type: string
        is_edited:
          type: boolean
        created_at:
          type: string
          format: date-time

    SendMessageRequest:
      type: object
      required:
        - config_id
        - message
      properties:
        conversation_id:
          type: string
          description: Existing conversation ID (optional - creates new if not provided)
        config_id:
          type: string
          description: LLM configuration ID
        message:
          type: string
          description: Message content
        attachments:
          type: array
          items:
            type: object
            properties:
              type:
                type: string
              url:
                type: string

    SendMessageResponse:
      type: object
      properties:
        conversation_id:
          type: string
        user_message:
          $ref: '#/components/schemas/Message'
        assistant_message:
          $ref: '#/components/schemas/Message'
        is_new_conversation:
          type: boolean

    LLMConfig:
      type: object
      properties:
        id:
          type: string
        owner_id:
          type: string
        name:
          type: string
        description:
          type: string
        model_id:
          type: string
        model_name:
          type: string
        system_prompt:
          type: string
        visibility:
          type: string
          enum: [private, public, template]
        avatar:
          type: object
          nullable: true
          properties:
            emoji:
              type: string
            color:
              type: string
        parameters:
          type: object
          properties:
            temperature:
              type: number
              minimum: 0
              maximum: 2
            max_tokens:
              type: integer
            top_p:
              type: number
            frequency_penalty:
              type: number
            presence_penalty:
              type: number
        tags:
          type: array
          items:
            type: string
        uses_count:
          type: integer
        created_at:
          type: string
          format: date-time

    LLMConfigCreate:
      type: object
      required:
        - name
        - model_id
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 100
        model_id:
          type: string
        model_name:
          type: string
        description:
          type: string
        system_prompt:
          type: string
          maxLength: 50000
        avatar:
          type: object
          properties:
            emoji:
              type: string
            color:
              type: string
        parameters:
          type: object
          properties:
            temperature:
              type: number
            max_tokens:
              type: integer
            top_p:
              type: number
        tags:
          type: array
          items:
            type: string

    LLMConfigUpdate:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        system_prompt:
          type: string
        model_id:
          type: string
        model_name:
          type: string
        avatar:
          type: object
        parameters:
          type: object
        tags:
          type: array
          items:
            type: string

    PaginatedResponse:
      type: object
      properties:
        total:
          type: integer
        page:
          type: integer
        limit:
          type: integer
        has_more:
          type: boolean

paths:
  # Auth endpoints
  /auth/register:
    post:
      tags:
        - Auth
      summary: Register a new user
      operationId: register
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '201':
          description: Registration successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  user:
                    $ref: '#/components/schemas/User'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Email already registered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /auth/login:
    post:
      tags:
        - Auth
      summary: Login and get access tokens
      operationId: login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '400':
          description: Missing credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Account suspended
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  reason:
                    type: string

  /auth/refresh:
    post:
      tags:
        - Auth
      summary: Refresh access token
      operationId: refreshToken
      security:
        - BearerAuth: []
      description: Requires refresh token (not access token) in Authorization header
      responses:
        '200':
          description: Token refreshed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenRefreshResponse'
        '401':
          description: Invalid or expired refresh token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /auth/logout:
    post:
      tags:
        - Auth
      summary: Logout and revoke token
      operationId: logout
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Successfully logged out
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /auth/me:
    get:
      tags:
        - Auth
      summary: Get current user information
      operationId: getCurrentUser
      security:
        - BearerAuth: []
      responses:
        '200':
          description: User information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfile'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /auth/password:
    put:
      tags:
        - Auth
      summary: Change password
      operationId: changePassword
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - current_password
                - new_password
              properties:
                current_password:
                  type: string
                  format: password
                new_password:
                  type: string
                  format: password
                  minLength: 8
      responses:
        '200':
          description: Password updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Current password incorrect
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # Conversations endpoints
  /conversations:
    get:
      tags:
        - Conversations
      summary: Get user's conversations
      operationId: getConversations
      security:
        - BearerAuth: []
      parameters:
        - name: folder_id
          in: query
          schema:
            type: string
          description: Filter by folder ID
        - name: archived
          in: query
          schema:
            type: boolean
            default: false
          description: Include archived conversations
        - name: search
          in: query
          schema:
            type: string
          description: Search term
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
        - name: sort
          in: query
          schema:
            type: string
            default: last_message_at
          description: Sort field
      responses:
        '200':
          description: List of conversations
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/PaginatedResponse'
                  - type: object
                    properties:
                      conversations:
                        type: array
                        items:
                          $ref: '#/components/schemas/Conversation'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    post:
      tags:
        - Conversations
      summary: Create a new conversation
      operationId: createConversation
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConversationCreate'
      responses:
        '201':
          description: Conversation created
          content:
            application/json:
              schema:
                type: object
                properties:
                  conversation:
                    $ref: '#/components/schemas/Conversation'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /conversations/{conversation_id}:
    get:
      tags:
        - Conversations
      summary: Get a specific conversation with messages
      operationId: getConversation
      security:
        - BearerAuth: []
      parameters:
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Conversation details
          content:
            application/json:
              schema:
                type: object
                properties:
                  conversation:
                    $ref: '#/components/schemas/Conversation'
                  messages:
                    type: array
                    items:
                      $ref: '#/components/schemas/Message'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Conversation not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    put:
      tags:
        - Conversations
      summary: Update conversation details
      operationId: updateConversation
      security:
        - BearerAuth: []
      parameters:
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConversationUpdate'
      responses:
        '200':
          description: Conversation updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  conversation:
                    $ref: '#/components/schemas/Conversation'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Conversation not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    delete:
      tags:
        - Conversations
      summary: Delete a conversation and its messages
      operationId: deleteConversation
      security:
        - BearerAuth: []
      parameters:
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Conversation deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Conversation not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /conversations/{conversation_id}/archive:
    post:
      tags:
        - Conversations
      summary: Toggle archive status
      operationId: toggleArchive
      security:
        - BearerAuth: []
      parameters:
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Archive status toggled
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  is_archived:
                    type: boolean
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Conversation not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /conversations/{conversation_id}/export:
    get:
      tags:
        - Conversations
      summary: Export conversation
      operationId: exportConversation
      security:
        - BearerAuth: []
      parameters:
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
        - name: format
          in: query
          schema:
            type: string
            enum: [json, markdown]
            default: markdown
        - name: metadata
          in: query
          schema:
            type: boolean
            default: true
          description: Include metadata in export
      responses:
        '200':
          description: Exported conversation
          content:
            application/json:
              schema:
                type: object
            text/markdown:
              schema:
                type: string
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Conversation not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /conversations/search:
    get:
      tags:
        - Conversations
      summary: Search conversations by title
      operationId: searchConversations
      security:
        - BearerAuth: []
      parameters:
        - name: q
          in: query
          required: true
          schema:
            type: string
          description: Search query
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                type: object
                properties:
                  conversations:
                    type: array
                    items:
                      $ref: '#/components/schemas/Conversation'
                  query:
                    type: string
        '400':
          description: Missing search query
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /conversations/search/messages:
    get:
      tags:
        - Conversations
      summary: Search within message content
      operationId: searchMessages
      security:
        - BearerAuth: []
      parameters:
        - name: q
          in: query
          required: true
          schema:
            type: string
          description: Search query
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
            maximum: 100
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/Message'
                  query:
                    type: string
                  total:
                    type: integer
        '400':
          description: Missing search query
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # Chat endpoints
  /chat/send:
    post:
      tags:
        - Chat
      summary: Send a message and get AI response
      operationId: sendMessage
      security:
        - BearerAuth: []
      description: |
        Send a message and receive a non-streaming AI response.
        For streaming responses, use WebSocket events instead.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendMessageRequest'
      responses:
        '200':
          description: Message sent and response received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SendMessageResponse'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Config or conversation not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '429':
          description: Token limit reached
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: AI generation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  user_message:
                    $ref: '#/components/schemas/Message'
                  assistant_message:
                    $ref: '#/components/schemas/Message'

  /chat/{conversation_id}/messages:
    get:
      tags:
        - Chat
      summary: Get messages for a conversation
      operationId: getMessages
      security:
        - BearerAuth: []
      parameters:
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 100
      responses:
        '200':
          description: List of messages
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    items:
                      $ref: '#/components/schemas/Message'
                  total:
                    type: integer
                  page:
                    type: integer
                  limit:
                    type: integer
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Conversation not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /chat/messages/{message_id}:
    put:
      tags:
        - Chat
      summary: Edit a user message
      operationId: editMessage
      security:
        - BearerAuth: []
      parameters:
        - name: message_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                regenerate:
                  type: boolean
                  default: true
                  description: Regenerate AI response after edit
      responses:
        '200':
          description: Message edited
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    $ref: '#/components/schemas/Message'
                  deleted_count:
                    type: integer
                  assistant_message:
                    $ref: '#/components/schemas/Message'
        '400':
          description: Invalid input or not a user message
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Message not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    delete:
      tags:
        - Chat
      summary: Delete a message
      operationId: deleteMessage
      security:
        - BearerAuth: []
      parameters:
        - name: message_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Message deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Message not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /chat/regenerate/{message_id}:
    post:
      tags:
        - Chat
      summary: Regenerate an assistant message
      operationId: regenerateMessage
      security:
        - BearerAuth: []
      parameters:
        - name: message_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Message regenerated
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    $ref: '#/components/schemas/Message'
        '400':
          description: No user message found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Message or config not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Generation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # Configs endpoints
  /configs:
    get:
      tags:
        - Configs
      summary: Get user's LLM configurations
      operationId: getConfigs
      security:
        - BearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
      responses:
        '200':
          description: List of configurations
          content:
            application/json:
              schema:
                type: object
                properties:
                  configs:
                    type: array
                    items:
                      $ref: '#/components/schemas/LLMConfig'
                  total:
                    type: integer
                  page:
                    type: integer
                  limit:
                    type: integer
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    post:
      tags:
        - Configs
      summary: Create a new LLM configuration
      operationId: createConfig
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LLMConfigCreate'
      responses:
        '201':
          description: Configuration created
          content:
            application/json:
              schema:
                type: object
                properties:
                  config:
                    $ref: '#/components/schemas/LLMConfig'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /configs/{config_id}:
    get:
      tags:
        - Configs
      summary: Get a specific configuration
      operationId: getConfig
      security:
        - BearerAuth: []
      parameters:
        - name: config_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Configuration details
          content:
            application/json:
              schema:
                type: object
                properties:
                  config:
                    $ref: '#/components/schemas/LLMConfig'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Configuration not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    put:
      tags:
        - Configs
      summary: Update a configuration
      operationId: updateConfig
      security:
        - BearerAuth: []
      parameters:
        - name: config_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LLMConfigUpdate'
      responses:
        '200':
          description: Configuration updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  config:
                    $ref: '#/components/schemas/LLMConfig'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Configuration not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    delete:
      tags:
        - Configs
      summary: Delete a configuration
      operationId: deleteConfig
      security:
        - BearerAuth: []
      parameters:
        - name: config_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Configuration deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Configuration not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /configs/{config_id}/publish:
    post:
      tags:
        - Configs
      summary: Make a configuration public
      operationId: publishConfig
      security:
        - BearerAuth: []
      parameters:
        - name: config_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Configuration published
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  visibility:
                    type: string
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Configuration not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /configs/{config_id}/unpublish:
    post:
      tags:
        - Configs
      summary: Make a configuration private
      operationId: unpublishConfig
      security:
        - BearerAuth: []
      parameters:
        - name: config_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Configuration unpublished
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  visibility:
                    type: string
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Configuration not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /configs/{config_id}/duplicate:
    post:
      tags:
        - Configs
      summary: Duplicate a configuration
      operationId: duplicateConfig
      security:
        - BearerAuth: []
      parameters:
        - name: config_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Custom name for the duplicate
      responses:
        '201':
          description: Configuration duplicated
          content:
            application/json:
              schema:
                type: object
                properties:
                  config:
                    $ref: '#/components/schemas/LLMConfig'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Configuration not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /configs/enhance-prompt:
    post:
      tags:
        - Configs
      summary: Enhance a system prompt using AI
      operationId: enhancePrompt
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - prompt
              properties:
                prompt:
                  type: string
                  maxLength: 10000
      responses:
        '200':
          description: Prompt enhanced
          content:
            application/json:
              schema:
                type: object
                properties:
                  enhanced_prompt:
                    type: string
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Enhancement failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
